{% extends 'base.html' %}
{% block content %}
<div class="continer">
  <h2>Manage Users</h2>
  <hr>
  <p>Manage users and their roles from this page.</p>

  <!-- User creation form -->
  <h3>Create New User</h3>
  <form method="post" action="{% url 'admin.create_user' %}">
    {% csrf_token %}
    <label for="username">Username:</label>
    <input type="text" name="username" id="username" required>
    <label for="password">Password:</label>
    <input type="password" name="password" id="password" required>
    <label for="role">Role:</label>
    <select name="role" id="role" required>
      <option value="ADMIN">Admin</option>
      <option value="JOB_SEEKER">Job Seeker</option>
      <option value="RECRUITER">Recruiter</option>
    </select>
    <button type="submit">Create User</button>
  </form>

  <ul>
    {% for users in template_data %}
      <li>
        {{ user.username }} - {{ user.profile.role }}
        {% if user.profile.role != ADMIN %}
        <form method="post" action="{% url 'admin.change_role_post' user.id %}" style="display:inline;">
          {% csrf_token %}
          <label for="role">Role:</label>
          <select name="role" id="role">
            <option value="ADMIN" {% if user.profile.role == 'ADMIN' %}selected{% endif %}>Admin</option>
            <option value="JOB_SEEKER" {% if user.profile.role == 'JOB_SEEKER' %}selected{% endif %}>Job Seeker</option>
            <option value="RECRUITER" {% if user.profile.role == 'RECRUITER' %}selected{% endif %}>Recruiter</option>
          </select>
          <button type="submit">Change Role</button>
        </form>
        {% endif %}
        <!-- Delete user button -->
        <form method="post" action="{% url 'admin.delete_user' user.id %}" style="display:inline;">
          {% csrf_token %}
          <button type="submit" onclick="return confirm('Are you sure you want to delete this user?');">Delete</button>
        </form>
      </li>
    {% endfor %}
  </ul>
</div>
{% endblock content %}