{% extends 'base.html' %}
{% block content %}
<div class="container">
  <h2>{{ template_data.title }}</h2>
  <hr>
  <!--display messages -->
  {% for message in template_data.messages %}
    <div class="card mb-3">
      <div class="card-header">
        <strong>From:</strong> {{ message.sender.username }} | 
        <strong>Subject:</strong> {{ message.subject }} | 
        <strong>Date:</strong> {{ message.timestamp|date:"M d, Y H:i" }}
      </div>
      <div class="card-body">
        <p>{{ message.body }}</p>
      </div>
      <div class="card-footer">
        {% if request.user.is_authenticated and request.user.username == message.recipient.username %}
          <form method="post" action="{% url 'messages.send_message' %}">
            {% csrf_token %}
            <input type="hidden" name="recipient" value="{{ message.sender.username }}">
            <input type="hidden" name="parent_id" value="{{ message.id }}">
            <input type="hidden" name="subject" value="Re: {{ message.subject }}">
            <div class="mb-2">
              <textarea name="body" class="form-control" rows="2" placeholder="Write a reply..." required></textarea>
            </div>
            <button type="submit" class="btn btn-sm btn-primary">Reply</button>
          </form>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <p>No messages found.</p>
  {% endfor %}
  <!--send messages-->
  <a href="{% url 'home.recruiter_send_messages' %}" class="btn btn-secondary mb-2">Send Message</a>
</div>
{% endblock %}